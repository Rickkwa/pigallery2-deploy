# pigallery2-deploy
Deployment configs for https://github.com/bpatrik/pigallery2


## Running it

Workspace setup:

```shell
WORKDIR=/app
git clone git@github.com:Rickkwa/pigallery2-deploy.git "${WORKDIR}"
mkdir -p ${WORKDIR}/_userdata/{images,tmp,config}
chown -R 9999:9999 ${WORKDIR}/_userdata/config/ ${WORKDIR}/_userdata/images/ ${WORKDIR}/_userdata/tmp/
```

Then follow these steps:

1. `docker compose up -d` to do first time initialization (generating the initial `config.json`).
1. In the UI, create a new admin user and delete the default `admin` user.
1. Then stop the containers, `docker compose down`.
1. Apply this repo's `pigallery/config.json` to the one generated by step #1. Ensure to keep the `sessionSecret` values from the initialized file.
1. Start containers up again with `docker compose up -d`. If you want to have prometheus/grafana running, do `docker compose -f docker-compose.yml -f docker-compose.monitoring.yml up -d`.
1. Start uploading photos to `${WORKDIR}/_userdata/images/`
